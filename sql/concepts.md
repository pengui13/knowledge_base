# Основні концепції баз даних

## Моделі організації даних

### Способи організації та зберігання даних

Моделі:
1. Реляційна - таблиці, зв'язки і співвідношення
2. Документна - JSON/BSON документи
3. Ключ-значення - пара key:value
4. Графова - вузли і зв'язки

Приклади:
- Реляційна: MySQL, PostgreSQL
- Документна: MongoDB
- Ключ-значення: Redis
- Графова: Neo4j

## SQL (Structured Query Language)

Мова операцій для виконання дій над даними.

## Транзакція

Група операцій, які виконуються як одне ціле.

Переваги транзакцій:
1. Зняти 100 грн з рахунку А
2. Додати 100 грн на рахунок Б

Або обидві виконані, або жодна.

## ACID властивості транзакцій

A - Atomicity (Атомарність)
Всі операції виконуються повністю або жодна.

C - Consistency (Консистентність)
Дані залишаються в узгодженому стані до і після транзакції.

I - Isolation (Ізольованість)
Транзакції не впливають одна на одну, незалежно виконуються. Одна транзакція не бачить незавершені зміни іншої.

D - Durability (Довговічність)
Після успішного завершення транзакції зміни зберігаються назавжди.

## Індекси

### Первинний код

Властивості:
- A: Для вертикального пошуку, від кореня до відколу
- C: Сама гілка - в ній всі дані
- I: Іван за first, послідовний пошук
- D: Повна успіху - дані вже знайдуті, нічого більше шукати

### Індекс (B-Tree / B+Tree)

Структура для швидкого пошуку.

Без індексу:
SELECT * FROM users WHERE email = 'test@gmail.com'

Повільно: перебирає всі рядки.

З індексом:
CREATE INDEX idx_email ON users(email);

Значно швидше.

### Типи індексів

#### B-Tree (Balanced Tree)

Стандартний індекс з деревом для швидкого пошуку.

Приклад структури:
        [50]
       /    \
    [25]    [75]
    /  \    /  \
  [10][30][60][90]

Підтримує операції:
- =, >, <, >=, <=
- BETWEEN
- ORDER BY
- LIKE 'abc%'

#### Hash індекс

Підтримує тільки оператор рівності.

SELECT * FROM users WHERE email = "test@gmail.com"

Принцип роботи:
Hash: email = "test@gmail.com"
hash() → bucket #7 → 17 рядків

Підтримує: тільки =
НЕ підтримує: порівняння (>, <), LIKE

#### Full-Text індекс

Для пошуку слів у тексті.

Навіщо: Якщо стовпець є слово "database".

SELECT * FROM articles WHERE MATCH(content) AGAINST('database');

Переваги:
- Пошук слів у великому тексті
- Індексує "the", "a", "is" (стоп-слова)
- Знаходить слова форми (run, running, ran)

B+TREE не підходить, бо LIKE '%database%' - повний перебір.

## Різниця між типами Backup

### Full (Повний)

Копіюємо все. Пошук: копіюємо всю БД (100 ГБ).

### Incremental (Інкрементний)

Після full backup: змінні за БТ.
Копіюємо лише зміни з останнього Backup.

### Differential (Диференційний)

Після full backup:
- Вт: Diff - зміни з початку (100 МБ)
- Ср: Diff - зміни з початку (200 МБ)

## Розподілені бази даних (Distributed)

Дані на кількох серверах.

Навіщо:
- Більше даних, ніж влізає на 1 сервер
- Відмовостійкість (один впав - інші працюють)
- Швидкість (сервер ближче до клієнта)

### Шардінг

Розподіл даних на кілька серверів.

Приклад:
- Сервер 1: користувачі А-М
- Сервер 2: користувачі N-Z

### Реплікація

Копіювання даних на кілька серверів.

Типи:
- Master-Slave: 1 пише, інші читають
- Master-Master: Всі пишуть

### Безпека даних

Аутентифікація: Логін/пароль
Авторизація: Права доступу
Шифрування: Дані зашифровані на диску
SQL Injection захист: Параметризовані запити

## Приклади використання індексів

### Приклад 1: Пошук користувача за email

Без індексу:
SELECT * FROM users WHERE email = 'test@gmail.com';
Час: 2 секунди (перебір 1 млн рядків)

З індексом:
CREATE INDEX idx_email ON users(email);
SELECT * FROM users WHERE email = 'test@gmail.com';
Час: 0.001 секунди

### Приклад 2: B-Tree для діапазонів

CREATE INDEX idx_age ON users(age);
SELECT * FROM users WHERE age BETWEEN 18 AND 25;

B-Tree дозволяє швидко знайти діапазон значень.

### Приклад 3: Full-Text пошук

CREATE FULLTEXT INDEX idx_content ON articles(content);
SELECT * FROM articles WHERE MATCH(content) AGAINST('database technology');

Знаходить статті зі словами "database" або "technology".

## Коли використовувати різні типи індексів

### B-Tree - універсальний вибір
- Пошук за точним значенням
- Діапазони (BETWEEN, >, <)
- Сортування (ORDER BY)
- Префіксний пошук (LIKE 'abc%')

### Hash - тільки точний пошук
- Дуже швидкий для =
- Не працює для діапазонів
- Ідеально для session ID, UUID

### Full-Text - пошук у тексті
- Пошук слів у великих текстах
- Статті, коментарі, описи
- Розуміє морфологію слів
