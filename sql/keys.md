# Ключі в базах даних

## 1. Primary Key (Первинний ключ)

**Визначення**: Унікально ідентифікує кожен рядок у таблиці.

**Правила**:
- Унікальний
- Не може бути NULL
- 1 таблиця = 1 PK

**Приклад - Таблиця Студенти**:

| ID (PK) | Ім'я | Вік |
|---------|------|-----|
| 1 | Петро | 20 |
| 2 | Марія | 22 |

ID - це Primary Key, бо кожен студент має унікальний номер.

## 2. Foreign Key (Зовнішній ключ)

**Визначення**: Посилання на Primary Key іншої таблиці. Зв'язує дві таблиці між собою.

**Приклад - Зв'язок Студентів і Замовлень**:

Таблиця Students:
| ID (PK) | Ім'я |
|---------|------|
| 1 | Петро |
| 2 | Марія |

Таблиця Orders:
| ID (PK) | Student_ID (FK) | Item |
|---------|-----------------|------|
| 1 | 1 | Book |
| 2 | 1 | Pen |

Student_ID у таблиці Orders - це Foreign Key, що посилається на ID у таблиці Students.

**Застосування**: З'ясовувати зв'язок між таблицями (наприклад, які замовлення зробив конкретний студент).

## 3. Candidate Key (Потенційний ключ)

**Визначення**: Поле (набір полів), яке може бути Primary Key.

**Правила**:
- Унікальне
- Не NULL

**Приклад - Таблиця Студенти**:

| Student_ID | Email | Name |
|------------|-------|------|
| 1 | petro@dm | Petro |
| 2 | maria@dm | Maria |

Candidate Keys:
- Student_ID (унікальний)
- Email (унікальний)

Primary Key вибрано Student_ID, але Email теж міг би бути Primary Key.

## 4. Composite Key (Складений ключ)

**Визначення**: Primary Key з 2+ полів разом.

**Коли використовувати**: Коли одне поле не може унікально ідентифікувати рядок.

**Приклад - Таблиця оцінок студентів**:

| Student_ID | Subject_ID | Mark |
|------------|------------|------|
| 1 | 101 | 5 |
| 1 | 102 | 4 |
| 2 | 101 | 5 |

PK = Student_ID + Subject_ID

Чому? 
- Один студент може мати багато предметів
- Один предмет можуть вивчати багато студентів
- Унікальна комбінація: студент 1, предмет 101

## Нормальні форми (NF)

### 1NF (Перша нормальна форма)

**Правило**: Кожна комірка = одне атомарне значення.

**Проблема - Не 1NF**:

| Student | Phones |
|---------|--------|
| Petro | 123, 456, 789 |

**Вирішення - 1NF**:

| Student | Phone |
|---------|-------|
| Petro | 123 |
| Petro | 456 |
| Petro | 789 |

### 2NF (Друга нормальна форма)

**Правило**: 1NF + кожне неключове поле залежить від всього Composite Key (якщо він є).

**Проблема - Не 2NF**:

Таблиця Students:
| Student_ID (PK) | Subject_ID (PK) | Mark | Subject_Name |
|-----------------|-----------------|------|--------------|
| 1 | 101 | 5 | Math |
| 1 | 102 | 4 | Physics |
| 2 | 101 | 5 | Math |

Проблема: Subject_Name залежить лише від Subject_ID, а не від всього ключа (Student_ID + Subject_ID).

**Вирішення - 2NF**:

Таблиця Оцінок:
| Student_ID | Subject_ID | Mark |
|------------|------------|------|
| 1 | 101 | 5 |
| 1 | 102 | 4 |
| 2 | 101 | 5 |

Таблиця Студентів:
| Student_ID | Name |
|------------|------|
| 1 | Petro |
| 2 | Maria |

### 3NF (Третя нормальна форма)

**Правило**: 2NF + немає транзитивних залежностей.

Транзитивна залежність: A → B → C (С залежить від А через В).

**Проблема - Не 3NF**:

| Student_ID | Subject_ID | Mark | Faculty_ID | Name_of_Faculty |
|------------|------------|------|------------|-----------------|
| 1 | 10 | 5 | 1 | Maths |
| 2 | 10 | 4 | 1 | Maths |

Student_ID → Faculty_ID → Name_of_Faculty (транзитивна залежність).

**Вирішення - 3NF**:

Таблиця Студентів:
| Student_ID | Faculty_ID |
|------------|------------|
| 1 | 1 |
| 2 | 1 |

Таблиця Факультетів:
| Faculty_ID | Name_of_Faculty |
|------------|-----------------|
| 1 | Maths |

### BCNF (Нормальна форма Бойса-Кодда)

**Правило**: Всі залежності від супер-ключа (Бойса = Кодда).

**Приклад**:

Таблиця Студентів:
| Student_ID | Faculty_ID | Teacher |
|------------|------------|---------|
| Petro | Algorithms | Ivanov |
| Maria | Algorithms | Ivanov |
| Petro | DB | Ivanov |
| Oleg | Network | Sydorov |

Key: Student + Course

Проблема: Course → Teacher (залежить не від супер-ключа).

**Вирішення - BCNF**:

Таблиця Course + Teacher:
| Course | Teacher |
|---------|---------|
| Algorithms | Ivanov |
| DB | Ivanov |
| Network | Sydorov |

Таблиця Student + Course:
| Student | Course |
|---------|----------|
| Petro | Algorithms |
| Petro | DB |
| Maria | Algorithms |

## Ключова різниця між NF

**1NF**: Атомарні значення (збільшується при атомарності).
**2NF**: Залежність неключового поля від всього ключа, не частини.
**3NF**: Немає транзитивних залежностей (поле залежить напряму від ключа).
**BCNF**: Усі залежності тільки від супер-ключа.

## Чому це важливо

- Усунення дублювання даних
- Легше оновлювати інформацію
- Краща цілісність даних
- Ефективніші запити
